-- admin ---------------

create user hifive
identified by hifive;

grant resource, connect 
to hifive;
------------------------

-- hifive ----------------





create sequence challenge_no_seq
    START WITH 1
    INCREMENT BY 1;
-- insert into challenges(cnum, ...) values(challenge_no_seq.nextval, ...); 형식으로 insert 가능

-- challengeNUM, challenge이름, 시작날짜, 종료날짜, 최대인원, 참가비, 현제 참가인원, 카테고리, 공휴일에 쉬는지, challenge사진
  CREATE TABLE "HIFIVE"."CHALLENGES" 
   (	"CNUM" NUMBER(5,0), 
	"NAME" VARCHAR2(50 BYTE) NOT NULL ENABLE, 
	"SDAY" DATE NOT NULL ENABLE, 
	"EDAY" DATE NOT NULL ENABLE, 
	"MPEOPLE" NUMBER(4,0) DEFAULT 1, 
	"FEE" NUMBER(10,0) DEFAULT 0, 
	"PARTICIPANT" NUMBER(4,0) DEFAULT 1, 
	"CATEGORY" VARCHAR2(50 BYTE) NOT NULL ENABLE, 
	"HOLIDAY" NUMBER(1,0) DEFAULT 0, 
	"PHOTO" VARCHAR2(100 BYTE), 
	 PRIMARY KEY ("CNUM")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
  
  -- challenge 휴일
  CREATE TABLE "HIFIVE"."CHOLIDAY" 
   (	"CNUM" NUMBER(5,0), 
	"HOLIDAY" DATE NOT NULL ENABLE, 
	 CONSTRAINT "SYS_C007965" PRIMARY KEY ("CNUM", "HOLIDAY")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE, 
	 FOREIGN KEY ("CNUM")
	  REFERENCES "HIFIVE"."CHALLENGES" ("CNUM") ON DELETE CASCADE ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
  
  -- challenge 참가정보. challengeNUM, 유저NUM
  CREATE TABLE "HIFIVE"."CPARTICIPANT" 
   (	"CNUM" NUMBER(5,0), 
	"UNUM" NUMBER(5,0), 
	 PRIMARY KEY ("CNUM", "UNUM")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE, 
	 FOREIGN KEY ("CNUM")
	  REFERENCES "HIFIVE"."CHALLENGES" ("CNUM") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "CPARTICIPANT_FK1" FOREIGN KEY ("UNUM")
	  REFERENCES "HIFIVE"."USER_TABLE" ("ID") ON DELETE CASCADE ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
  
  -- 인증사진, validates는 문제없으면 1 있으면 0
    CREATE TABLE "HIFIVE"."CPHOTO" 
   (	"CNUM" NUMBER(5,0), 
	"UNUM" NUMBER(5,0), 
	"PHOTO" VARCHAR2(100 BYTE) NOT NULL ENABLE, 
	"COMENT" VARCHAR2(25 BYTE) DEFAULT NULL, 
	"UPLOADDATE" DATE NOT NULL ENABLE, 
	"VALIDATES" NUMBER(1,0) DEFAULT 1, 
	 CONSTRAINT "CPHOTO_PK" PRIMARY KEY ("CNUM", "UNUM", "UPLOADDATE")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE, 
	 FOREIGN KEY ("CNUM")
	  REFERENCES "HIFIVE"."CHALLENGES" ("CNUM") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "SYS_C007865" FOREIGN KEY ("UNUM")
	  REFERENCES "HIFIVE"."USER_TABLE" ("ID") ON DELETE CASCADE ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
  
  -- 문제있는 인증사진의 올린사람 NUM, 올린 chaallengeNUM, 올린날짜, 신고한사람의 NUM
   CREATE TABLE "HIFIVE"."VERIFYREPORT" 
   (	"CNUM" NUMBER(5,0), 
	"UNUM" NUMBER(5,0), 
	"UPLOADDATE" DATE NOT NULL ENABLE, 
	"REPORTUNUM" NUMBER(5,0) DEFAULT 1 NOT NULL ENABLE, 
	 CONSTRAINT "SYS_C008054" PRIMARY KEY ("CNUM", "UNUM", "UPLOADDATE", "REPORTUNUM")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE, 
	 CONSTRAINT "VERIFYREPORT_FK1" FOREIGN KEY ("REPORTUNUM")
	  REFERENCES "HIFIVE"."USER_TABLE" ("ID") ON DELETE CASCADE ENABLE, 
	 CONSTRAINT "VERIFYREPORT_FK2" FOREIGN KEY ("CNUM", "UNUM", "UPLOADDATE")
	  REFERENCES "HIFIVE"."CPHOTO" ("CNUM", "UNUM", "UPLOADDATE") ON DELETE CASCADE ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
-----------------------------
